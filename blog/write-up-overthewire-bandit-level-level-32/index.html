<!doctype html><html lang=en><head><title>Write-up: OverTheWire - Bandit Level Level 32 â†’ Level 33 | Justin Perdok</title><meta name=title content="Write-up: OverTheWire - Bandit Level Level 32 â†’ Level 33 | Justin Perdok"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><base href=https://justin-p.me/><meta name=description content="IT Geek, Ethical Hacker, DevOps Nut, PowerShell Fanatic and lover of beersðŸ»"><meta name=author content="Justin Perdok"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@JustinPerdok"><meta name=twitter:creator content="@JustinPerdok"><meta property="og:title" content="Write-up: OverTheWire - Bandit Level Level 32 â†’ Level 33 | Justin Perdok"><meta property="og:type" content="website"><meta property="og:url" content="https://justin-p.me/"><meta property="og:image" content="https://justin-p.me//images/osprey.png"><meta property="og:description" content="IT Geek, Ethical Hacker, DevOps Nut, PowerShell Fanatic and lover of beersðŸ»"><link rel=icon type=image/png sizes=16x16 href=favicon.ico><meta name=theme-color content="#FFF"><link rel=canonical href=https://justin-p.me/blog/write-up-overthewire-bandit-level-level-32/><link rel=stylesheet href=https://justin-p.me/style.3d9ed0c8ed4a7de59d1a99f6c56fa9ab43daaa5b8951f2082b11faa9417532b8.css type=text/css><style>.lazyload{opacity:.0001}.logo .lazyload{min-width:10em}</style><script src=https://justin-p.me/js/vendor/lazysizes.min.js async></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css></head><body><nav class="row middle-xs center-xs"><div class="col-xs-6 col-sm-1 logo"><a href=https://justin-p.me/#><img data-src=https://justin-p.me/images/me.png class=lazyload lazyload=on alt="Justin Perdok"></a></div><div class="col-xs-3 col-sm-2"><h3><a href=https://justin-p.me/#about>About</a></h3></div><div class="col-xs-3 col-sm-2"><h3><a href=https://justin-p.me/#work>Work</a></h3></div><div class="col-xs-3 col-sm-2"><h3><a href=https://justin-p.me/#blog>Blog</a></h3></div><div class="col-xs-6 col-sm-1 nav-toggle"><a href class=nav-icon onclick=return!1><img data-src=https://justin-p.me/images/icon-menu.png class=lazyload lazyload=on alt="Open Menu">
<img data-src=https://justin-p.me/images/icon-x.png class=lazyload lazyload=on alt="Close Menu" style=display:none></a></div></nav><section class="nav-full row middle-xs center-xs"><div class=col-xs-12><div class="row middle-xs center-xs"><div class=col-xs-12><h1><a href=https://justin-p.me/#about>About</a></h1></div><div class=col-xs-12><h1><a href=https://justin-p.me/#work>Work</a></h1></div><div class=col-xs-12><h1><a href=https://justin-p.me/#blog>Blog</a></h1></div></div></div></section><main><section class=container><section class=content><h1>Write-up: OverTheWire - Bandit Level Level 32 â†’ Level 33</h1><div class=sub-header>September 12, 2019 Â· 2 minutes read</div><article class=entry-content><h3 id=bandit-level-32--level-33>Bandit Level 32 â†’ Level 33</h3><p><strong>Level Goal:</strong>
<em>After all this git stuff its time for another escape. Good luck!</em></p><p>This level requires is to log in with <code>ssh</code> with bandit32. That means its time to say goodbye to our MoreVimShell.</p><p>When we connect we are created with by someone seems to have had a field day with caps lock enabled. It seems we have a some sort of shell where every command we type is converted to uppercase. We are able to call some environment variables though.</p><pre tabindex=0><code>ssh bandit32@bandit.labs.overthewire.org -p 2220

WELCOME TO THE UPPERCASE SHELL
&gt;&gt;
&gt;&gt; ls
sh: 1: LS: not found
&gt;&gt; echo
sh: 1: ECHO: not found
&gt;&gt; printenv
sh: 1: PRINTENV: not found
&gt;&gt; $SHELL
WELCOME TO THE UPPERCASE SHELL
&gt;&gt; $PATH
sh: 1: /usr/local/bin:/usr/bin:/bin:/usr/games: not found
&gt;&gt; $BASH
</code></pre><p>I then decided to try some random <a href=https://www.cyberciti.biz/faq/linux-list-all-environment-variables-env-command/>environment variables</a>.</p><pre tabindex=0><code>&gt;&gt; $BASH_VERSION
&gt;&gt; $HOSTNAME
&gt;&gt; $CDPATH
&gt;&gt; $HISTFILE
&gt;&gt; $HISTFILESIZE
&gt;&gt; $HISTSIZE
&gt;&gt; $HOME
sh: 1: /home/bandit32: Permission denied
&gt;&gt; $IFS
&gt;&gt; $LANG
sh: 1: en_US.UTF-8: not found
&gt;&gt; $PATH
sh: 1: /usr/local/bin:/usr/bin:/bin:/usr/games: not found
&gt;&gt; $PS1
sh: 1: $: not found
&gt;&gt; $TMOUT
&gt;&gt; $TERM
sh: 1: xterm-256color: not found
&gt;&gt; $DISPLAY
&gt;&gt; $EDITOR
</code></pre><p>Since this yielded no results I to read over the <code>bash</code> man page where I stumbled on <code>Special Parameters</code>.</p><p>Where <code>$0</code> looked someone what promising. This could contain something like <code>/bin/sh</code>.</p><blockquote><p>($0) Expands to the name of the shell or shell script. This is set at shell initialization. If Bash is invoked with a file of commands (see Shell Scripts), $0 is set to the name of that file. If Bash is started with the -c option (see Invoking Bash), then $0 is set to the first argument after the string to be executed, if one is present. Otherwise, it is set to the filename used to invoke Bash, as given by argument zero.</p></blockquote><p>Which seemed to be the case. This gave me a <code>/bin/sh</code> shell where I spawned <code>/bin/bash</code> and proceeded to <code>cat</code> the password file.</p><pre tabindex=0><code>&gt;&gt; $*
&gt;&gt; $@
&gt;&gt; $#
sh: 1: 0: not found
&gt;&gt; $?
sh: 1: 0: not found
&gt;&gt; $-
&gt;&gt; $$
sh: 1: 6806: not found
&gt;&gt; $!
&gt;&gt; $0
$
$ /bin/bash
bandit33@bandit:~$
bandit33@bandit:~$ cat /etc/bandit_pass/bandit33
c9c3199ddf4121b10cf581a98d51caee
</code></pre></article><div class=pagination><a href=https://justin-p.me/blog/write-up-overthewire-bandit-level-27-level-32/>&#171; Write-up: OverTheWire - Bandit Level 27 â†’ Level 32</a></div></section><br><section class=disqus><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t="",e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view comments powered by <a href=http://disqus.com/?ref_noscript>Disqus</a>.</noscript></section></section></main><footer class="row middle-xs center-xs"><div class="col-xs-3 col-md-2"><a target=_blank rel=noopener href=https://github.com/justin-p>GitHub</a></div><div class="col-xs-3 col-md-2"><a target=_blank rel=noopener href=https://linkedin.com/in/justinperdok>LinkedIn</a></div><div class="col-xs-3 col-md-2"><a target=_blank rel=noopener href=https://twitter.com/JustinPerdok>Twitter</a></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><script src=https://justin-p.me/js/src/main.min.2eb0efba04f9d46cd2be0d81caa4f00de5b2ba8295e0fff3220fe4b02edf1e36.js type=text/javascript></script></body></html>