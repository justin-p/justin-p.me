<!doctype html><html lang=en>
<head>
<title>
Write-up: OverTheWire - Bandit Level 5 → Level 7 | Justin Perdok
</title>
<meta name=title content="Write-up: OverTheWire - Bandit Level 5 → Level 7 | Justin Perdok">
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="chrome=1">
<meta name=HandheldFriendly content="True">
<meta name=MobileOptimized content="320">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=referrer content="no-referrer-when-downgrade">
<base href=https://justin-p.me/>
<meta name=description content="IT Geek, Ethical Hacker, DevOps Nut, PowerShell Fanatic and lover of beers🍻">
<meta name=author content="Justin Perdok">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:site content="@JustinPerdok">
<meta name=twitter:creator content="@JustinPerdok">
<meta property="og:title" content="Write-up: OverTheWire - Bandit Level 5 → Level 7 | Justin Perdok">
<meta property="og:type" content="website">
<meta property="og:url" content="https://justin-p.me/">
<meta property="og:image" content="https://justin-p.me//images/osprey.png">
<meta property="og:description" content="IT Geek, Ethical Hacker, DevOps Nut, PowerShell Fanatic and lover of beers🍻">
<link rel=icon type=image/png sizes=16x16 href=favicon.ico>
<meta name=theme-color content="#FFF">
<link rel=canonical href=https://justin-p.me/blog/write-up-overthewire-bandit5/>
<link rel=stylesheet href=https://justin-p.me/style.3d9ed0c8ed4a7de59d1a99f6c56fa9ab43daaa5b8951f2082b11faa9417532b8.css type=text/css>
<style>.lazyload{opacity:.0001}.logo .lazyload{min-width:10em}</style>
<script src=https://justin-p.me/js/vendor/lazysizes.min.js async></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css>
</head>
<body>
<nav class="row middle-xs center-xs">
<div class="col-xs-6 col-sm-1 logo">
<a href=https://justin-p.me/#><img data-src=https://justin-p.me/images/me.png class=lazyload lazyload=on alt="Justin Perdok"></a>
</div>
<div class="col-xs-3 col-sm-2">
<h3><a href=https://justin-p.me/#about>About</a></h3>
</div>
<div class="col-xs-3 col-sm-2">
<h3><a href=https://justin-p.me/#work>Work</a></h3>
</div>
<div class="col-xs-3 col-sm-2">
<h3><a href=https://justin-p.me/#blog>Blog</a></h3>
</div>
<div class="col-xs-6 col-sm-1 nav-toggle">
<a href class=nav-icon onclick=return!1>
<img data-src=https://justin-p.me/images/icon-menu.png class=lazyload lazyload=on alt="Open Menu">
<img data-src=https://justin-p.me/images/icon-x.png class=lazyload lazyload=on alt="Close Menu" style=display:none>
</a>
</div>
</nav>
<section class="nav-full row middle-xs center-xs">
<div class=col-xs-12>
<div class="row middle-xs center-xs">
<div class=col-xs-12><h1><a href=https://justin-p.me/#about>About</a></h1></div>
<div class=col-xs-12><h1><a href=https://justin-p.me/#work>Work</a></h1></div>
<div class=col-xs-12><h1><a href=https://justin-p.me/#blog>Blog</a></h1></div>
</div>
</div>
</section>
<main>
<section class=container>
<section class=content>
<h1> Write-up: OverTheWire - Bandit Level 5 → Level 7 </h1>
<div class=sub-header>
September 11, 2019 · 5 minutes read
</div>
<article class=entry-content>
<h3 id=bandit-level-5--level-6>Bandit Level 5 → Level 6</h3>
<p><strong>Level Goal:</strong>
<em>The password for the next level is stored in a file somewhere under the inhere directory and has all of the following properties:</em></p>
<ul>
<li><em>human-readable</em></li>
<li><em>1033 bytes in size</em></li>
<li><em>not executable</em></li>
</ul>
<p>Welp in this case I think its time to bust out trusty old <code>find</code>. The level goal gives us some clear hints what we can use to filter with <code>find</code>.</p>
<pre tabindex=0><code>~/wargames/overthewire/bandit$ ssh bandit5@bandit.labs.overthewire.org -p 2220

bandit5@bandit~$ ls
inhere
bandit5@bandit~$ cd inhere/
bandit5@bandit~/inhere$ ls -la
total 88
drwxr-x--- 22 root bandit5 4096 Oct 16  2018 .
drwxr-xr-x  3 root root    4096 Oct 16  2018 ..
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere00
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere01
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere02
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere03
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere04
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere05
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere06
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere07
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere08
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere09
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere10
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere11
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere12
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere13
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere14
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere15
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere16
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere17
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere18
drwxr-x---  2 root bandit5 4096 Oct 16  2018 maybehere19

</code></pre><p>So <code>find</code> is pretty handy tool. <code>find</code> searches one or more directory trees of a file system, it then locates files based on user-specified filters and can even apply a user-specified action on each matched file!</p>
<p>So we know that the file is somewhere in the folder <code>inhere</code>. Since we already <code>cd</code> into this folder we can simply supply a dot <code>.</code> to <code>find</code>. A dot <code>.</code> simply represents the current directory.</p>
<p>We also know from the level goal that this is a file, so we use the <code>-type</code> flag. By specifying <code>f</code> on the <code>-type</code> flag where are telling find to search for files.</p>
<p>Next thing on the list is <code>human-readable</code> text. <code>find</code> has a <code>-readable</code> flag you can supply, this however does not filter for human-readable. It simply matches files which are readable by the current user. We can however use <code>strings</code> later to filter for <code>human-readable</code> text.</p>
<p>Another thing we know is that password file is not executable. <code>find</code> has a flag for that, <code>-executable</code>. If we supply it like that it will filter for files that are executable. We don&rsquo;t want that, we can fix this by using the <code>!</code> operator.</p>
<p>Last thing is file size, the level goal tells us the password file is 1033 bytes. Again <code>find</code> has a flag for that, <code>-size</code>. The <code>-size</code> flag has multiple suffixes, we can use <code>c</code> to specify that our number is in bytes.</p>
<p>That should cover our filter. Now for our action. We can use the <code>-exec</code> flag for this. You should probably read the <code>find</code> man page to read up on <code>-exec</code>. In our case we want to <code>cat</code> each file that find finds.</p>
<p>So after all that we have the following command:</p>
<pre tabindex=0><code>find . -type f -readable ! -executable -size 1033c -exec cat {} \;

</code></pre><p>To ensure the output only contains <code>human-readable</code> text we can simply pipe <code>|</code> this to <code>strings</code>.</p>
<pre tabindex=0><code>bandit5@bandit~/inhere$ find . -type f -readable ! -executable -size 1033c -exec cat {} \; | strings
DXjZPULLxYr17uwoI01bNLQbtFemEgo7

bandit5@bandit~/inhere$ logout
Connection to bandit.labs.overthewire.org closed.

</code></pre><h3 id=bandit-level-6--level-7>Bandit Level 6 → Level 7</h3>
<p><strong>Level Goal:</strong>
*The password for the next level is stored somewhere on the server and has all of the following properties:</p>
<pre><code>owned by user bandit7
owned by group bandit6
33 bytes in size
</code></pre>
<ul>
<li></li>
</ul>
<p>So lets check out home folder&mldr; ow wait&mldr; no file. In that case, lets just use <code>find</code> on the root of the file structure!</p>
<pre tabindex=0><code>~/wargames/overthewire/bandit$ ssh bandit6@bandit.labs.overthewire.org -p 2220


bandit6@bandit~$ ls -lA
total 20
-rw-r--r--  1 root root  220 May 15  2017 .bash_logout
-rw-r--r--  1 root root 3526 May 15  2017 .bashrc
-rw-r--r--  1 root root  675 May 15  2017 .profile
bandit6@bandit~$ cd /
</code></pre><p>We already know how to specify the file size and location. To specify a user or group we can use the <code>-group</code> and <code>-user</code> flags.</p>
<pre tabindex=0><code>bandit6@bandit:/$ find . -size 33c -group bandit6 -user bandit7 -readable -exec cat {} \; | strings
find: ‘./run/lvm’: Permission denied
find: ‘./run/screen/S-bandit16’: Permission denied
find: ‘./run/screen/S-bandit26’: Permission denied
</code></pre><p>To avoid all these <code>Permission denied</code> being returned to our shell we can redirect a thing called <code>stderr</code> to a place called <code>/dev/null</code>.</p>
<p><code>stderr</code> , also known as standard error, is the default file descriptor where a process can write error messages.</p>
<p><code>/dev/null</code> , also known as the null device, is a device file that discards all data written to it but reports that the write operation succeeded.</p>
<p>We can redirect <code>stderr</code> to <code>/dev/null</code> with <code>2>/dev/null</code>. When we run it with this redirection we simply get the password.</p>
<pre tabindex=0><code>bandit6@bandit/$ find . -size 33c -group bandit6 -user bandit7 2&gt;/dev/null -exec cat {} \; | strings
HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs

bandit6@bandit/$ logout
Connection to bandit.labs.overthewire.org closed.
</code></pre>
</article>
<div class=pagination>
<a href=https://justin-p.me/blog/writeup-overthewire-bandit0-5/>&#171; Write-up: OverTheWire - Bandit level 0 → Bandit level 5</a>
<a href=https://justin-p.me/blog/write-up-overthewire-bandit-level-7-level-12/>Write-up: OverTheWire - Bandit Level 7 → Level 12 &#187;</a>
</div>
</section>
<br>
<section class=disqus>
<div id=disqus_thread></div>
<script type=text/javascript>(function(){var b,a;if(window.location.hostname=="localhost")return;b='',a=document.createElement('script'),a.type='text/javascript',a.async=!0,a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view comments powered by <a href=http://disqus.com/?ref_noscript>Disqus</a>.</noscript>
</section>
</section>
</main>
<footer class="row middle-xs center-xs">
<div class="col-xs-3 col-md-2"><a target=_blank rel=noopener href=https://github.com/justin-p>GitHub</a></div>
<div class="col-xs-3 col-md-2"><a target=_blank rel=noopener href=https://linkedin.com/in/justinperdok>LinkedIn</a></div>
<div class="col-xs-3 col-md-2"><a target=_blank rel=noopener href=https://twitter.com/JustinPerdok>Twitter</a></div>
</footer>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script>
<script src=https://justin-p.me/js/src/main.min.eae71e379c2461af7fb34269ff746c36d0aa5343dd34e47314df0f3808c2d2a1.js type=text/javascript></script>
</body>
</html>